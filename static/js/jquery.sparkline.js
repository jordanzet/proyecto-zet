(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(i){var p={},m,E,r,B,s,k,F,G,u,c,d,H,x,l,q,D,z,g,o,A,e,a,C,t,n,I,b,w,j,y,v,h,f=0;m=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:false,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:false,enableHighlight:true,highlightLighten:1.4,tooltipSkipNull:true,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:false,numberFormatter:false,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:false,disableInteraction:false},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:undefined,normalRangeMax:undefined,normalRangeColor:"#ccc",drawNormalOnTop:false,chartRangeMin:undefined,chartRangeMax:undefined,chartRangeMinX:undefined,chartRangeMaxX:undefined,tooltipFormat:new r('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:undefined,nullColor:undefined,zeroAxis:true,barWidth:4,barSpacing:1,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:false,colorMap:undefined,tooltipFormat:new r('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new r('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss","0":"Draw","1":"Win"}}},discrete:{lineHeight:"auto",thresholdColor:undefined,thresholdValue:0,chartRangeMax:undefined,chartRangeMin:undefined,chartRangeClip:false,tooltipFormat:new r("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:undefined,tooltipFormat:new r("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new r('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:false,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:true,outlierIQR:1.5,spotRadius:1.5,target:undefined,targetColor:"#4a2",chartRangeMax:undefined,chartRangeMin:undefined,tooltipFormat:new r("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}};I='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}';E=function(){var J,K;J=function(){this.init.apply(this,arguments)};if(arguments.length>1){if(arguments[0]){J.prototype=i.extend(new arguments[0](),arguments[arguments.length-1]);J._super=arguments[0].prototype}else{J.prototype=arguments[arguments.length-1]}if(arguments.length>2){K=Array.prototype.slice.call(arguments,1,-1);K.unshift(J.prototype);i.extend.apply(i,K)}}else{J.prototype=arguments[0]}J.prototype.cls=J;return J};i.SPFormatClass=r=E({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(K,J){this.format=K;this.fclass=J},render:function(R,P,S){var Q=this,O=R,N,K,L,M,J;return this.format.replace(this.fre,function(){var T;K=arguments[1];L=arguments[3];N=Q.precre.exec(K);if(N){J=N[2];K=N[1]}else{J=false}M=O[K];if(M===undefined){return""}if(L&&P&&P[L]){T=P[L];if(T.get){return P[L].get(M)||M}else{return P[L][M]||M}}if(u(M)){if(S.get("numberFormatter")){M=S.get("numberFormatter")(M)}else{M=l(M,J,S.get("numberDigitGroupCount"),S.get("numberDigitGroupSep"),S.get("numberDecimalMark"))}}return M})}});i.spformat=function(K,J){return new r(K,J)};B=function(L,K,J){if(L<K){return K}if(L>J){return J}return L};s=function(J,L){var K;if(L===2){K=Math.floor(J.length/2);return J.length%2?J[K]:(J[K-1]+J[K])/2}else{if(J.length%2){K=(J.length*L+L)/4;return K%1?(J[Math.floor(K)]+J[Math.floor(K)-1])/2:J[K-1]}else{K=(J.length*L+2)/4;return K%1?(J[Math.floor(K)]+J[Math.floor(K)-1])/2:J[K-1]}}};k=function(K){var J;switch(K){case"undefined":K=undefined;break;case"null":K=null;break;case"true":K=true;break;case"false":K=false;break;default:J=parseFloat(K);if(K==J){K=J}}return K};F=function(L){var K,J=[];for(K=L.length;K--;){J[K]=k(L[K])}return J};G=function(N,L){var K,M,J=[];for(K=0,M=N.length;K<M;K++){if(N[K]!==L){J.push(N[K])}}return J};u=function(J){return !isNaN(parseFloat(J))&&isFinite(J)};l=function(L,K,J,O,N){var P,M;L=(K===false?parseFloat(L).toString():L.toFixed(K)).split("");P=(P=i.inArray(".",L))<0?L.length:P;if(P<L.length){L[P]=N}for(M=P-J;M>0;M-=J){L.splice(M,0,O)}return L.join("")};c=function(M,K,J){var L;for(L=K.length;L--;){if(J&&K[L]===null){continue}if(K[L]!==M){return false}}return true};d=function(L){var K=0,J;for(J=L.length;J--;){K+=typeof L[J]==="number"?L[J]:0}return K};x=function(J){return i.isArray(J)?J:[J]};H=function(K){var J;if(document.createStyleSheet){document.createStyleSheet().cssText=K}else{J=document.createElement("style");J.type="text/css";document.getElementsByTagName("head")[0].appendChild(J);J[(typeof document.body.style.WebkitAppearance=="string")?"innerText":"innerHTML"]=K}};i.fn.simpledraw=function(M,J,K,L){var O,N;if(K&&(O=this.data("_jqs_vcanvas"))){return O}if(M===undefined){M=i(this).innerWidth()}if(J===undefined){J=i(this).innerHeight()}if(i.browser.hasCanvas){O=new y(M,J,this,L)}else{if(i.browser.msie){O=new v(M,J,this)}else{return false}}N=i(this).data("_jqs_mhandler");if(N){N.registerCanvas(O)}return O};i.fn.cleardraw=function(){var J=this.data("_jqs_vcanvas");if(J){J.reset()}};i.RangeMapClass=q=E({init:function(M){var L,J,K=[];for(L in M){if(M.hasOwnProperty(L)&&typeof L==="string"&&L.indexOf(":")>-1){J=L.split(":");J[0]=J[0].length===0?-Infinity:parseFloat(J[0]);J[1]=J[1].length===0?Infinity:parseFloat(J[1]);J[2]=M[L];K.push(J)}}this.map=M;this.rangelist=K||false},get:function(N){var M=this.rangelist,L,K,J;if((J=this.map[N])!==undefined){return J}if(M){for(L=M.length;L--;){K=M[L];if(K[0]<=N&&K[1]>=N){return K[2]}}}return undefined}});i.range_map=function(J){return new q(J)};D=E({init:function(L,J){var K=i(L);this.$el=K;this.options=J;this.currentPageX=0;this.currentPageY=0;this.el=L;this.splist=[];this.tooltip=null;this.over=false;this.displayTooltips=!J.get("disableTooltips");this.highlightEnabled=!J.get("disableHighlight")},registerSparkline:function(J){this.splist.push(J);if(this.over){this.updateDisplay()}},registerCanvas:function(J){var K=i(J.canvas);this.canvas=J;this.$canvas=K;K.mouseenter(i.proxy(this.mouseenter,this));K.mouseleave(i.proxy(this.mouseleave,this));K.click(i.proxy(this.mouseclick,this))},reset:function(J){this.splist=[];if(this.tooltip&&J){this.tooltip.remove();this.tooltip=undefined}},mouseclick:function(K){var J=i.Event("sparklineClick");J.originalEvent=K;J.sparklines=this.splist;this.$el.trigger(J)},mouseenter:function(J){i(document.body).unbind("mousemove.jqs");i(document.body).bind("mousemove.jqs",i.proxy(this.mousemove,this));this.over=true;this.currentPageX=J.pageX;this.currentPageY=J.pageY;this.currentEl=J.target;if(!this.tooltip&&this.displayTooltips){this.tooltip=new z(this.options);this.tooltip.updatePosition(J.pageX,J.pageY)}this.updateDisplay()},mouseleave:function(){i(document.body).unbind("mousemove.jqs");var M=this.splist,J=M.length,L=false,N,K;this.over=false;this.currentEl=null;if(this.tooltip){this.tooltip.remove();this.tooltip=null}for(K=0;K<J;K++){N=M[K];if(N.clearRegionHighlight()){L=true}}if(L){this.canvas.render()}},mousemove:function(J){this.currentPageX=J.pageX;this.currentPageY=J.pageY;this.currentEl=J.target;if(this.tooltip){this.tooltip.updatePosition(J.pageX,J.pageY)}this.updateDisplay()},updateDisplay:function(){var K=this.splist,Q=K.length,O=false,N=this.$canvas.offset(),M=this.currentPageX-N.left,L=this.currentPageY-N.top,R,J,P,T,S;if(!this.over){return}for(P=0;P<Q;P++){J=K[P];T=J.setRegionHighlight(this.currentEl,M,L);if(T){O=true}}if(O){S=i.Event("sparklineRegionChange");S.sparklines=this.splist;this.$el.trigger(S);if(this.tooltip){R="";for(P=0;P<Q;P++){J=K[P];R+=J.getCurrentRegionTooltip()}this.tooltip.setContent(R)}if(!this.disableHighlight){this.canvas.render()}}if(T===null){this.mouseleave()}}});z=E({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(J){var M=J.get("tooltipClassname","jqstooltip"),K=this.sizeStyle,L;this.container=J.get("tooltipContainer")||document.body;this.tooltipOffsetX=J.get("tooltipOffsetX",10);this.tooltipOffsetY=J.get("tooltipOffsetY",12);i("#jqssizetip").remove();i("#jqstooltip").remove();this.sizetip=i("<div/>",{id:"jqssizetip",style:K,"class":M});this.tooltip=i("<div/>",{id:"jqstooltip","class":M}).appendTo(this.container);L=this.tooltip.offset();this.offsetLeft=L.left;this.offsetTop=L.top;this.hidden=true;i(window).unbind("resize.jqs scroll.jqs");i(window).bind("resize.jqs scroll.jqs",i.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=i(window).scrollTop();this.scrollLeft=i(window).scrollLeft();this.scrollRight=this.scrollLeft+i(window).width();this.updatePosition()},getSize:function(J){this.sizetip.html(J).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(J){if(!J){this.tooltip.css("visibility","hidden");this.hidden=true;return}this.getSize(J);this.tooltip.html(J).css({width:this.width,height:this.height,visibility:"visible"});if(this.hidden){this.hidden=false;this.updatePosition()}},updatePosition:function(J,K){if(J===undefined){if(this.mousex===undefined){return}J=this.mousex-this.offsetLeft;K=this.mousey-this.offsetTop}else{this.mousex=J=J-this.offsetLeft;this.mousey=K=K-this.offsetTop}if(!this.height||!this.width||this.hidden){return}K-=this.height+this.tooltipOffsetY;J+=this.tooltipOffsetX;if(K<this.scrollTop){K=this.scrollTop}if(J<this.scrollLeft){J=this.scrollLeft}else{if(J+this.width>this.scrollRight){J=this.scrollRight-this.width}}this.tooltip.css({left:J,top:K})},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=undefined;i(window).unbind("resize.jqs scroll.jqs")}});b=function(){H(I)};i(b);h=[];i.fn.sparkline=function(J,K){return this.each(function(){var L=new i.fn.sparkline.options(this,K),O=i(this),N,M;N=function(){var Q,S,P,R,V,U,T;if(J==="html"||J===undefined){T=this.getAttribute(L.get("tagValuesAttribute"));if(T===undefined||T===null){T=O.html()}Q=T.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{Q=J}S=L.get("width")==="auto"?Q.length*L.get("defaultPixelsPerValue"):L.get("width");if(L.get("height")==="auto"){if(!L.get("composite")||!i.data(this,"_jqs_vcanvas")){R=document.createElement("span");R.innerHTML="a";O.html(R);P=i(R).innerHeight()||i(R).height();i(R).remove();R=null}}else{P=L.get("height")}if(!L.get("disableInteraction")){V=i.data(this,"_jqs_mhandler");if(!V){V=new D(this,L);i.data(this,"_jqs_mhandler",V)}else{if(!L.get("composite")){V.reset()}}}else{V=false}if(L.get("composite")&&!i.data(this,"_jqs_vcanvas")){if(!i.data(this,"_jqs_errnotify")){alert("Attempted to attach a composite sparkline to an element with no existing sparkline");i.data(this,"_jqs_errnotify",true)}return}U=new i.fn.sparkline[L.get("type")](this,Q,L,S,P);U.render();if(V){V.registerSparkline(U)}};if((i(this).html()&&!L.get("disableHiddenCheck")&&i(this).is(":hidden"))||(i.fn.jquery<"1.3.0"&&i(this).parents().is(":hidden"))||!i(this).parents("body").length){if(!L.get("composite")&&i.data(this,"_jqs_pending")){for(M=h.length;M;M--){if(h[M-1][0]==this){h.splice(M-1,1)}}}h.push([this,N]);i.data(this,"_jqs_pending",true)}else{N.call(this)}})};i.fn.sparkline.defaults=m();i.sparkline_display_visible=function(){var M,K,L;var J=[];for(K=0,L=h.length;K<L;K++){M=h[K][0];if(i(M).is(":visible")&&!i(M).parents().is(":hidden")){h[K][1].call(M);i.data(h[K][0],"_jqs_pending",false);J.push(K)}else{if(!i(M).closest("html").length&&!i.data(M,"_jqs_pending")){i.data(h[K][0],"_jqs_pending",false);J.push(K)}}}for(K=J.length;K;K--){h.splice(J[K-1],1)}};i.fn.sparkline.options=E({init:function(J,O){var N,M,L,K;this.userOptions=O=O||{};this.tag=J;this.tagValCache={};M=i.fn.sparkline.defaults;L=M.common;this.tagOptionsPrefix=O.enableTagOptions&&(O.tagOptionsPrefix||L.tagOptionsPrefix);K=this.getTagSetting("type");if(K===p){N=M[O.type||L.type]}else{N=M[K]}this.mergedOptions=i.extend({},L,N,O)},getTagSetting:function(L){var N=this.tagOptionsPrefix,O,K,M,J;if(N===false||N===undefined){return p}if(this.tagValCache.hasOwnProperty(L)){O=this.tagValCache.key}else{O=this.tag.getAttribute(N+L);if(O===undefined||O===null){O=p}else{if(O.substr(0,1)==="["){O=O.substr(1,O.length-2).split(",");for(K=O.length;K--;){O[K]=k(O[K].replace(/(^\s*)|(\s*$)/g,""))}}else{if(O.substr(0,1)==="{"){M=O.substr(1,O.length-2).split(",");O={};for(K=M.length;K--;){J=M[K].split(":",2);O[J[0].replace(/(^\s*)|(\s*$)/g,"")]=k(J[1].replace(/(^\s*)|(\s*$)/g,""))}}else{O=k(O)}}}this.tagValCache.key=O}return O},get:function(M,L){var K=this.getTagSetting(M),J;if(K!==p){return K}return(J=this.mergedOptions[M])===undefined?L:J}});i.fn.sparkline._base=E({disabled:false,init:function(N,K,L,M,J){this.el=N;this.$el=i(N);this.values=K;this.options=L;this.width=M;this.height=J;this.currentRegion=undefined},initTarget:function(){var J=!this.options.get("disableInteraction");if(!(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),J))){this.disabled=true}else{this.canvasWidth=this.target.pixelWidth;this.canvasHeight=this.target.pixelHeight}},render:function(){if(this.disabled){this.el.innerHTML="";return false}return true},getRegion:function(J,K){},setRegionHighlight:function(L,J,O){var M=this.currentRegion,K=!this.options.get("disableHighlight"),N;if(J>this.canvasWidth||O>this.canvasHeight||J<0||O<0){return null}N=this.getRegion(L,J,O);if(M!==N){if(M!==undefined&&K){this.removeHighlight()}this.currentRegion=N;if(N!==undefined&&K){this.renderHighlight()}return true}return false},clearRegionHighlight:function(){if(this.currentRegion!==undefined){this.removeHighlight();this.currentRegion=undefined;return true}return false},renderHighlight:function(){this.changeHighlight(true)},removeHighlight:function(){this.changeHighlight(false)},changeHighlight:function(J){},getCurrentRegionTooltip:function(){var Z=this.options,O="",P=[],Q,V,J,S,Y,N,R,M,T,L,X,W,U,K;if(this.currentRegion===undefined){return""}Q=this.getCurrentRegionFields();X=Z.get("tooltipFormatter");if(X){return X(this,Z,Q)}if(Z.get("tooltipChartTitle")){O+='<div class="jqs jqstitle">'+Z.get("tooltipChartTitle")+"</div>\n"}V=this.options.get("tooltipFormat");if(!V){return""}if(!i.isArray(V)){V=[V]}if(!i.isArray(Q)){Q=[Q]}R=this.options.get("tooltipFormatFieldlist");M=this.options.get("tooltipFormatFieldlistKey");if(R&&M){T=[];for(N=Q.length;N--;){L=Q[N][M];if((K=i.inArray(L,R))!=-1){T[K]=Q[N]}}Q=T}J=V.length;U=Q.length;for(N=0;N<J;N++){W=V[N];if(typeof W==="string"){W=new r(W)}S=W.fclass||"jqsfield";for(K=0;K<U;K++){if(!Q[K].isNull||!Z.get("tooltipSkipNull")){i.extend(Q[K],{prefix:Z.get("tooltipPrefix"),suffix:Z.get("tooltipSuffix")});Y=W.render(Q[K],Z.get("tooltipValueLookups"),Z);P.push('<div class="'+S+'">'+Y+"</div>")}}}if(P.length){return O+P.join("\n")}return""},getCurrentRegionFields:function(){},calcHighlightColor:function(J,K){var Q=K.get("highlightColor"),M=K.get("highlightLighten"),P,O,N,L;if(Q){return Q}if(M){P=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(J)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(J);if(P){N=[];O=J.length===4?16:1;for(L=0;L<3;L++){N[L]=B(Math.round(parseInt(P[L+1],16)*O*M),0,255)}return"rgb("+N.join(",")+")"}}return J}});g={changeHighlight:function(L){var N=this.currentRegion,M=this.target,J=this.regionShapes[N],K;if(J){K=this.renderRegion(N,L);if(i.isArray(K)||i.isArray(J)){M.replaceWithShapes(J,K);this.regionShapes[N]=i.map(K,function(O){return O.id})}else{M.replaceWithShape(J,K);this.regionShapes[N]=K.id}}},render:function(){var K=this.values,O=this.target,P=this.regionShapes,J,N,M,L;if(!this.cls._super.render.call(this)){return}for(M=K.length;M--;){J=this.renderRegion(M);if(J){if(i.isArray(J)){N=[];for(L=J.length;L--;){J[L].append();N.push(J[L].id)}P[M]=N}else{J.append();P[M]=J.id}}else{P[M]=null}}O.render()}};i.fn.sparkline.line=o=E(i.fn.sparkline._base,{type:"line",init:function(N,K,L,M,J){o._super.init.call(this,N,K,L,M,J);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.hightlightSpotId=null;this.lastShapeId=null;this.initTarget()},getRegion:function(L,J,N){var K,M=this.regionMap;for(K=M.length;K--;){if(M[K]!==null&&J>=M[K][0]&&J<=M[K][1]){return M[K][2]}}return undefined},getCurrentRegionFields:function(){var J=this.currentRegion;return{isNull:this.yvalues[J]===null,x:this.xvalues[J],y:this.yvalues[J],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:J}},renderHighlight:function(){var J=this.currentRegion,Q=this.target,N=this.vertices[J],R=this.options,M=R.get("spotRadius"),L=R.get("highlightSpotColor"),O=R.get("highlightLineColor"),K,P;if(!N){return}if(M&&L){K=Q.drawCircle(N[0],N[1],M,undefined,L);this.highlightSpotId=K.id;Q.insertAfterShape(this.lastShapeId,K)}if(O){P=Q.drawLine(N[0],this.canvasTop,N[0],this.canvasTop+this.canvasHeight,O);this.highlightLineId=P.id;Q.insertAfterShape(this.lastShapeId,P)}},removeHighlight:function(){var J=this.target;if(this.highlightSpotId){J.removeShapeId(this.highlightSpotId);this.highlightSpotId=null}if(this.highlightLineId){J.removeShapeId(this.highlightLineId);this.highlightLineId=null}},scanValues:function(){var R=this.values,L=R.length,J=this.xvalues,P=this.yvalues,S=this.yminmax,N,M,Q,O,K;for(N=0;N<L;N++){M=R[N];Q=typeof(R[N])==="string";O=typeof(R[N])==="object"&&R[N] instanceof Array;K=Q&&R[N].split(":");if(Q&&K.length===2){J.push(Number(K[0]));P.push(Number(K[1]));S.push(Number(K[1]))}else{if(O){J.push(M[0]);P.push(M[1]);S.push(M[1])}else{J.push(N);if(R[N]===null||R[N]==="null"){P.push(null)}else{P.push(Number(M));S.push(Number(M))}}}}if(this.options.get("xvalues")){J=this.options.get("xvalues")}this.maxy=this.maxyorg=Math.max.apply(Math,S);this.miny=this.minyorg=Math.min.apply(Math,S);this.maxx=Math.max.apply(Math,J);this.minx=Math.min.apply(Math,J);this.xvalues=J;this.yvalues=P;this.yminmax=S},processRangeOptions:function(){var K=this.options,J=K.get("normalRangeMin"),L=K.get("normalRangeMax");if(J!==undefined){if(J<this.miny){this.miny=J}if(L>this.maxy){this.maxy=L}}if(K.get("chartRangeMin")!==undefined&&(K.get("chartRangeClip")||K.get("chartRangeMin")<this.miny)){this.miny=K.get("chartRangeMin")}if(K.get("chartRangeMax")!==undefined&&(K.get("chartRangeClip")||K.get("chartRangeMax")>this.maxy)){this.maxy=K.get("chartRangeMax")}if(K.get("chartRangeMinX")!==undefined&&(K.get("chartRangeClipX")||K.get("chartRangeMinX")<this.minx)){this.minx=K.get("chartRangeMinX")}if(K.get("chartRangeMaxX")!==undefined&&(K.get("chartRangeClipX")||K.get("chartRangeMaxX")>this.maxx)){this.maxx=K.get("chartRangeMaxX")}},drawNormalRange:function(L,P,O,M,Q){var J=this.options.get("normalRangeMin"),N=this.options.get("normalRangeMax"),K=P+Math.round(O-(O*((N-this.miny)/Q))),R=Math.round((O*(N-J))/Q);this.target.drawRect(L,K,M,R,undefined,this.options.get("normalRangeColor")).append()},render:function(){var P=this.options,an=this.target,ak=this.canvasWidth,M=this.canvasHeight,S=this.vertices,ao=P.get("spotRadius"),Z=this.regionMap,L,K,ae,ai,ag,aj,aa,ad,X,W,ac,N,al,V,ab,am,O,Q,Y,J,T,af,U,R,ah;if(!o._super.render.call(this)){return}this.scanValues();this.processRangeOptions();U=this.xvalues;R=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}ai=ag=0;L=this.maxx-this.minx===0?1:this.maxx-this.minx;K=this.maxy-this.miny===0?1:this.maxy-this.miny;ae=this.yvalues.length-1;if(ao&&(ak<(ao*4)||M<(ao*4))){ao=0}if(ao){T=P.get("highlightSpotColor")&&!P.get("disableInteraction");if(T||P.get("minSpotColor")||(P.get("spotColor")&&R[ae]===this.miny)){M-=Math.ceil(ao)}if(T||P.get("maxSpotColor")||(P.get("spotColor")&&R[ae]===this.maxy)){M-=Math.ceil(ao);ai+=Math.ceil(ao)}if(T||((P.get("minSpotColor")||P.get("maxSpotColor"))&&(R[0]===this.miny||R[0]===this.maxy))){ag+=Math.ceil(ao);ak-=Math.ceil(ao)}if(T||P.get("spotColor")||(P.get("minSpotColor")||P.get("maxSpotColor")&&(R[ae]===this.miny||R[ae]===this.maxy))){ak-=Math.ceil(ao)}}M--;if(P.get("normalRangeMin")!==undefined&&!P.get("drawNormalOnTop")){this.drawNormalRange(ag,ai,M,ak,K)}aa=[];ad=[aa];V=ab=null;am=R.length;for(ah=0;ah<am;ah++){X=U[ah];ac=U[ah+1];W=R[ah];N=ag+Math.round((X-this.minx)*(ak/L));al=ah<am-1?ag+Math.round((ac-this.minx)*(ak/L)):ak;ab=N+((al-N)/2);Z[ah]=[V||0,ab,ah];V=ab;if(W===null){if(ah){if(R[ah-1]!==null){aa=[];ad.push(aa)}S.push(null)}}else{if(W<this.miny){W=this.miny}if(W>this.maxy){W=this.maxy}if(!aa.length){aa.push([N,ai+M])}aj=[N,ai+Math.round(M-(M*((W-this.miny)/K)))];aa.push(aj);S.push(aj)}}O=[];Q=[];Y=ad.length;for(ah=0;ah<Y;ah++){aa=ad[ah];if(aa.length){if(P.get("fillColor")){aa.push([aa[aa.length-1][0],(ai+M)]);Q.push(aa.slice(0));aa.pop()}if(aa.length>2){aa[0]=[aa[0][0],aa[1][1]]}O.push(aa)}}Y=Q.length;for(ah=0;ah<Y;ah++){an.drawShape(Q[ah],P.get("fillColor"),P.get("fillColor")).append()}if(P.get("normalRangeMin")!==undefined&&P.get("drawNormalOnTop")){this.drawNormalRange(ag,ai,M,ak,K)}Y=O.length;for(ah=0;ah<Y;ah++){an.drawShape(O[ah],P.get("lineColor"),undefined,P.get("lineWidth")).append()}if(ao&&P.get("valueSpots")){J=P.get("valueSpots");if(J.get===undefined){J=new q(J)}for(ah=0;ah<am;ah++){af=J.get(R[ah]);if(af){an.drawCircle(ag+Math.round((U[ah]-this.minx)*(ak/L)),ai+Math.round(M-(M*((R[ah]-this.miny)/K))),ao,undefined,af).append()}}}if(ao&&P.get("spotColor")){an.drawCircle(ag+Math.round((U[U.length-1]-this.minx)*(ak/L)),ai+Math.round(M-(M*((R[ae]-this.miny)/K))),ao,undefined,P.get("spotColor")).append()}if(this.maxy!==this.minyorg){if(ao&&P.get("minSpotColor")){X=U[i.inArray(this.minyorg,R)];an.drawCircle(ag+Math.round((X-this.minx)*(ak/L)),ai+Math.round(M-(M*((this.minyorg-this.miny)/K))),ao,undefined,P.get("minSpotColor")).append()}if(ao&&P.get("maxSpotColor")){X=U[i.inArray(this.maxyorg,R)];an.drawCircle(ag+Math.round((X-this.minx)*(ak/L)),ai+Math.round(M-(M*((this.maxyorg-this.miny)/K))),ao,undefined,P.get("maxSpotColor")).append()}}this.lastShapeId=an.getLastShapeId();this.canvasTop=ai;an.render()}});i.fn.sparkline.bar=A=E(i.fn.sparkline._base,g,{type:"bar",init:function(aq,at,X,J,K){var Z=parseInt(X.get("barWidth"),10),ab=parseInt(X.get("barSpacing"),10),P=X.get("chartRangeMin"),ag=X.get("chartRangeMax"),M=X.get("chartRangeClip"),ak=Infinity,T=-Infinity,au,Q,ai,Y,ah,ap,aj,O,ad,V,ar,W,ao,U,al,N,an,ae,R,aa,L,am,af;A._super.init.call(this,aq,at,X,J,K);for(ap=0,aj=at.length;ap<aj;ap++){aa=at[ap];au=typeof(aa)==="string"&&aa.indexOf(":")>-1;if(au||i.isArray(aa)){al=true;if(au){aa=at[ap]=F(aa.split(":"))}aa=G(aa,null);Q=Math.min.apply(Math,aa);ai=Math.max.apply(Math,aa);if(Q<ak){ak=Q}if(ai>T){T=ai}}}this.stacked=al;this.regionShapes={};this.barWidth=Z;this.barSpacing=ab;this.totalBarWidth=Z+ab;this.width=J=(at.length*Z)+((at.length-1)*ab);this.initTarget();if(M){ao=P===undefined?-Infinity:P;U=ag===undefined?Infinity:ag}ah=[];Y=al?[]:ah;var ac=[];var S=[];for(ap=0,aj=at.length;ap<aj;ap++){if(al){N=at[ap];at[ap]=R=[];ac[ap]=0;Y[ap]=S[ap]=0;for(an=0,ae=N.length;an<ae;an++){aa=R[an]=M?B(N[an],ao,U):N[an];if(aa!==null){if(aa>0){ac[ap]+=aa}if(ak<0&&T>0){if(aa<0){S[ap]+=Math.abs(aa)}else{Y[ap]+=aa}}else{Y[ap]+=Math.abs(aa-(aa<0?T:ak))}ah.push(aa)}}}else{aa=M?B(at[ap],ao,U):at[ap];aa=at[ap]=k(aa);if(aa!==null){ah.push(aa)}}}this.max=W=Math.max.apply(Math,ah);this.min=ar=Math.min.apply(Math,ah);this.stackMax=T=al?Math.max.apply(Math,ac):W;this.stackMin=ak=al?Math.min.apply(Math,ah):ar;if(X.get("chartRangeMin")!==undefined&&(X.get("chartRangeClip")||X.get("chartRangeMin")<ar)){ar=X.get("chartRangeMin")}if(X.get("chartRangeMax")!==undefined&&(X.get("chartRangeClip")||X.get("chartRangeMax")>W)){W=X.get("chartRangeMax")}this.zeroAxis=ad=X.get("zeroAxis",true);if(ar<=0&&W>=0&&ad){V=0}else{if(ad==false){V=ar}else{if(ar>0){V=ar}else{V=W}}}this.xaxisOffset=V;O=al?(Math.max.apply(Math,Y)+Math.max.apply(Math,S)):W-ar;this.canvasHeightEf=(ad&&ar<0)?this.canvasHeight-2:this.canvasHeight-1;if(ar<V){am=(al&&W>=0)?T:W;L=(am-V)/O*this.canvasHeight;if(L!==Math.ceil(L)){this.canvasHeightEf-=2;L=Math.ceil(L)}}else{L=this.canvasHeight}this.yoffset=L;if(i.isArray(X.get("colorMap"))){this.colorMapByIndex=X.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=X.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===undefined){this.colorMapByValue=new q(this.colorMapByValue)}}this.range=O},getRegion:function(L,K,M){var J=Math.floor(K/this.totalBarWidth);return(J<0||J>=this.values.length)?undefined:J},getCurrentRegionFields:function(){var N=this.currentRegion,K=x(this.values[N]),J=[],M,L;for(L=K.length;L--;){M=K[L];J.push({isNull:M===null,value:M,color:this.calcColor(L,M,N),offset:N})}return J},calcColor:function(N,O,P){var Q=this.colorMapByIndex,M=this.colorMapByValue,L=this.options,J,K;if(this.stacked){J=L.get("stackedBarColor")}else{J=(O<0)?L.get("negBarColor"):L.get("barColor")}if(O===0&&L.get("zeroColor")!==undefined){J=L.get("zeroColor")}if(M&&(K=M.get(O))){J=K}else{if(Q&&Q.length>P){J=Q[P]}}return i.isArray(J)?J[N%J.length]:J},renderRegion:function(T,N){var V=this.values[T],L=this.options,J=this.xaxisOffset,R=[],W=this.range,ac=this.stacked,ad=this.target,Q=T*this.totalBarWidth,K=this.canvasHeightEf,S=this.yoffset,P,X,Z,Y,O,aa,M,ae,ab,U;V=i.isArray(V)?V:[V];M=V.length;ae=V[0];Y=c(null,V);U=c(J,V,true);if(Y){if(L.get("nullColor")){Z=N?L.get("nullColor"):this.calcHighlightColor(L.get("nullColor"),L);P=(S>0)?S-1:S;return ad.drawRect(Q,P,this.barWidth-1,0,Z,Z)}else{return undefined}}O=S;for(aa=0;aa<M;aa++){ae=V[aa];if(ac&&ae===J){if(!U||ab){continue}ab=true}if(W>0){X=Math.floor(K*((Math.abs(ae-J)/W)))+1}else{X=1}if(ae<J||(ae===J&&S===0)){P=O;O+=X}else{P=S-X;S-=X}Z=this.calcColor(aa,ae,T);if(N){Z=this.calcHighlightColor(Z,L)}R.push(ad.drawRect(Q,P,this.barWidth-1,X-1,Z,Z))}if(R.length===1){return R[0]}return R}});i.fn.sparkline.tristate=e=E(i.fn.sparkline._base,g,{type:"tristate",init:function(O,K,L,N,J){var M=parseInt(L.get("barWidth"),10),P=parseInt(L.get("barSpacing"),10);e._super.init.call(this,O,K,L,N,J);this.regionShapes={};this.barWidth=M;this.barSpacing=P;this.totalBarWidth=M+P;this.values=i.map(K,Number);this.width=N=(K.length*M)+((K.length-1)*P);if(i.isArray(L.get("colorMap"))){this.colorMapByIndex=L.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=L.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===undefined){this.colorMapByValue=new q(this.colorMapByValue)}}this.initTarget()},getRegion:function(K,J,L){return Math.floor(J/this.totalBarWidth)},getCurrentRegionFields:function(){var J=this.currentRegion;return{isNull:this.values[J]===undefined,value:this.values[J],color:this.calcColor(this.values[J],J),offset:J}},calcColor:function(O,P){var K=this.values,N=this.options,Q=this.colorMapByIndex,M=this.colorMapByValue,J,L;if(M&&(L=M.get(O))){J=L}else{if(Q&&Q.length>P){J=Q[P]}else{if(K[P]<0){J=N.get("negBarColor")}else{if(K[P]>0){J=N.get("posBarColor")}else{J=N.get("zeroBarColor")}}}}return J},renderRegion:function(M,J){var R=this.values,T=this.options,N=this.target,L,S,O,Q,P,K;L=N.pixelHeight;O=Math.round(L/2);Q=M*this.totalBarWidth;if(R[M]<0){P=O;S=O-1}else{if(R[M]>0){P=0;S=O-1}else{P=O-1;S=2}}K=this.calcColor(R[M],M);if(K===null){return}if(J){K=this.calcHighlightColor(K,T)}return N.drawRect(Q,P,this.barWidth-1,S-1,K,K)}});i.fn.sparkline.discrete=a=E(i.fn.sparkline._base,g,{type:"discrete",init:function(N,K,L,M,J){a._super.init.call(this,N,K,L,M,J);this.regionShapes={};this.values=K=i.map(K,Number);this.min=Math.min.apply(Math,K);this.max=Math.max.apply(Math,K);this.range=this.max-this.min;this.width=M=L.get("width")==="auto"?K.length*2:this.width;this.interval=Math.floor(M/K.length);this.itemWidth=M/K.length;if(L.get("chartRangeMin")!==undefined&&(L.get("chartRangeClip")||L.get("chartRangeMin")<this.min)){this.min=L.get("chartRangeMin")}if(L.get("chartRangeMax")!==undefined&&(L.get("chartRangeClip")||L.get("chartRangeMax")>this.max)){this.max=L.get("chartRangeMax")}this.initTarget();if(this.target){this.lineHeight=L.get("lineHeight")==="auto"?Math.round(this.canvasHeight*0.3):L.get("lineHeight")}},getRegion:function(K,J,L){return Math.floor(J/this.itemWidth)},getCurrentRegionFields:function(){var J=this.currentRegion;return{isNull:this.values[J]===undefined,value:this.values[J],offset:J}},renderRegion:function(R,M){var X=this.values,Y=this.options,O=this.min,U=this.max,Q=this.range,K=this.interval,T=this.target,P=this.canvasHeight,W=this.lineHeight,S=P-W,J,L,N,V;L=B(X[R],O,U);V=R*K;J=Math.round(S-S*((L-O)/Q));N=(Y.get("thresholdColor")&&L<Y.get("thresholdValue"))?Y.get("thresholdColor"):Y.get("lineColor");if(M){N=this.calcHighlightColor(N,Y)}return T.drawLine(V,J,V,J+W,N)}});i.fn.sparkline.bullet=C=E(i.fn.sparkline._base,{type:"bullet",init:function(P,L,M,O,K){var N,J,Q;C._super.init.call(this,P,L,M,O,K);this.values=L=F(L);Q=L.slice();Q[0]=Q[0]===null?Q[2]:Q[0];Q[1]=L[1]===null?Q[2]:Q[1];N=Math.min.apply(Math,L);J=Math.max.apply(Math,L);if(M.get("base")===undefined){N=N<0?N:0}else{N=M.get("base")}this.min=N;this.max=J;this.range=J-N;this.shapes={};this.valueShapes={};this.regiondata={};this.width=O=M.get("width")==="auto"?"4.0em":O;this.target=this.$el.simpledraw(O,K,M.get("composite"));if(!L.length){this.disabled=true}this.initTarget()},getRegion:function(K,J,M){var L=this.target.getShapeAt(K,J,M);return(L!==undefined&&this.shapes[L]!==undefined)?this.shapes[L]:undefined},getCurrentRegionFields:function(){var J=this.currentRegion;return{fieldkey:J.substr(0,1),value:this.values[J.substr(1)],region:J}},changeHighlight:function(K){var M=this.currentRegion,L=this.valueShapes[M],J;delete this.shapes[L];switch(M.substr(0,1)){case"r":J=this.renderRange(M.substr(1),K);break;case"p":J=this.renderPerformance(K);break;case"t":J=this.renderTarget(K);break}this.valueShapes[M]=J.id;this.shapes[J.id]=M;this.target.replaceWithShape(L,J)},renderRange:function(M,K){var N=this.values[M],L=Math.round(this.canvasWidth*((N-this.min)/this.range)),J=this.options.get("rangeColors")[M-2];if(K){J=this.calcHighlightColor(J,this.options)}return this.target.drawRect(0,0,L-1,this.canvasHeight-1,J,J)},renderPerformance:function(K){var M=this.values[1],L=Math.round(this.canvasWidth*((M-this.min)/this.range)),J=this.options.get("performanceColor");if(K){J=this.calcHighlightColor(J,this.options)}return this.target.drawRect(0,Math.round(this.canvasHeight*0.3),L-1,Math.round(this.canvasHeight*0.4)-1,J,J)},renderTarget:function(L){var O=this.values[0],J=Math.round(this.canvasWidth*((O-this.min)/this.range)-(this.options.get("targetWidth")/2)),N=Math.round(this.canvasHeight*0.1),M=this.canvasHeight-(N*2),K=this.options.get("targetColor");if(L){K=this.calcHighlightColor(K,this.options)}return this.target.drawRect(J,N,this.options.get("targetWidth")-1,M-1,K,K)},render:function(){var M=this.values.length,L=this.target,K,J;if(!C._super.render.call(this)){return}for(K=2;K<M;K++){J=this.renderRange(K).append();this.shapes[J.id]="r"+K;this.valueShapes["r"+K]=J.id}if(this.values[1]!==null){J=this.renderPerformance().append();this.shapes[J.id]="p1";this.valueShapes.p1=J.id}if(this.values[0]!==null){J=this.renderTarget().append();this.shapes[J.id]="t0";this.valueShapes.t0=J.id}L.render()}});i.fn.sparkline.pie=t=E(i.fn.sparkline._base,{type:"pie",init:function(O,K,L,N,J){var P=0,M;t._super.init.call(this,O,K,L,N,J);this.shapes={};this.valueShapes={};this.values=K=i.map(K,Number);if(L.get("width")==="auto"){this.width=this.height}if(K.length>0){for(M=K.length;M--;){P+=K[M]}}this.total=P;this.initTarget();this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(K,J,M){var L=this.target.getShapeAt(K,J,M);return(L!==undefined&&this.shapes[L]!==undefined)?this.shapes[L]:undefined},getCurrentRegionFields:function(){var J=this.currentRegion;return{isNull:this.values[J]===undefined,value:this.values[J],percent:this.values[J]/this.total*100,color:this.options.get("sliceColors")[J%this.options.get("sliceColors").length],offset:J}},changeHighlight:function(J){var M=this.currentRegion,K=this.renderSlice(M,J),L=this.valueShapes[M];delete this.shapes[L];this.target.replaceWithShape(L,K);this.valueShapes[M]=K.id;this.shapes[K.id]=M},renderSlice:function(S,M){var U=this.target,Y=this.options,T=this.radius,J=Y.get("borderWidth"),P=Y.get("offset"),K=2*Math.PI,X=this.values,V=this.total,R=P?(2*Math.PI)*(P/360):0,L,O,Q,W,N;W=X.length;for(Q=0;Q<W;Q++){L=R;O=R;if(V>0){O=R+(K*(X[Q]/V))}if(S===Q){N=Y.get("sliceColors")[Q%Y.get("sliceColors").length];if(M){N=this.calcHighlightColor(N,Y)}return U.drawPieSlice(T,T,T-J,L,O,undefined,N)}R=O}},render:function(){var P=this.target,M=this.values,N=this.options,J=this.radius,L=N.get("borderWidth"),K,O;if(!t._super.render.call(this)){return}if(L){P.drawCircle(J,J,Math.floor(J-(L/2)),N.get("borderColor"),undefined,L).append()}for(O=M.length;O--;){if(M[O]){K=this.renderSlice(O).append();this.valueShapes[O]=K.id;this.shapes[K.id]=O}}P.render()}});i.fn.sparkline.box=n=E(i.fn.sparkline._base,{type:"box",init:function(N,K,L,M,J){n._super.init.call(this,N,K,L,M,J);this.values=i.map(K,Number);this.width=L.get("width")==="auto"?"4.0em":M;this.initTarget();if(!this.values.length){this.disabled=1}},getRegion:function(){return 1},getCurrentRegionFields:function(){var J=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];if(this.loutlier!==undefined){J.push({field:"lo",value:this.loutlier})}if(this.routlier!==undefined){J.push({field:"ro",value:this.routlier})}if(this.lwhisker!==undefined){J.push({field:"lw",value:this.lwhisker})}if(this.rwhisker!==undefined){J.push({field:"rw",value:this.rwhisker})}return J},render:function(){var ac=this.target,M=this.values,Q=M.length,O=this.options,ab=this.canvasWidth,K=this.canvasHeight,V=O.get("chartRangeMin")===undefined?Math.min.apply(Math,M):O.get("chartRangeMin"),aa=O.get("chartRangeMax")===undefined?Math.max.apply(Math,M):O.get("chartRangeMax"),X=0,U,Z,N,T,S,R,J,P,Y,W,L;if(!n._super.render.call(this)){return}if(O.get("raw")){if(O.get("showOutliers")&&M.length>5){Z=M[0];U=M[1];T=M[2];S=M[3];R=M[4];J=M[5];P=M[6]}else{U=M[0];T=M[1];S=M[2];R=M[3];J=M[4]}}else{M.sort(function(ae,ad){return ae-ad});T=s(M,1);S=s(M,2);R=s(M,3);N=R-T;if(O.get("showOutliers")){U=J=undefined;for(Y=0;Y<Q;Y++){if(U===undefined&&M[Y]>T-(N*O.get("outlierIQR"))){U=M[Y]}if(M[Y]<R+(N*O.get("outlierIQR"))){J=M[Y]}}Z=M[0];P=M[Q-1]}else{U=M[0];J=M[Q-1]}}this.quartiles=[T,S,R];this.lwhisker=U;this.rwhisker=J;this.loutlier=Z;this.routlier=P;L=ab/(aa-V+1);if(O.get("showOutliers")){X=Math.ceil(O.get("spotRadius"));ab-=2*Math.ceil(O.get("spotRadius"));L=ab/(aa-V+1);if(Z<U){ac.drawCircle((Z-V)*L+X,K/2,O.get("spotRadius"),O.get("outlierLineColor"),O.get("outlierFillColor")).append()}if(P>J){ac.drawCircle((P-V)*L+X,K/2,O.get("spotRadius"),O.get("outlierLineColor"),O.get("outlierFillColor")).append()}}ac.drawRect(Math.round((T-V)*L+X),Math.round(K*0.1),Math.round((R-T)*L),Math.round(K*0.8),O.get("boxLineColor"),O.get("boxFillColor")).append();ac.drawLine(Math.round((U-V)*L+X),Math.round(K/2),Math.round((T-V)*L+X),Math.round(K/2),O.get("lineColor")).append();ac.drawLine(Math.round((U-V)*L+X),Math.round(K/4),Math.round((U-V)*L+X),Math.round(K-K/4),O.get("whiskerColor")).append();ac.drawLine(Math.round((J-V)*L+X),Math.round(K/2),Math.round((R-V)*L+X),Math.round(K/2),O.get("lineColor")).append();ac.drawLine(Math.round((J-V)*L+X),Math.round(K/4),Math.round((J-V)*L+X),Math.round(K-K/4),O.get("whiskerColor")).append();ac.drawLine(Math.round((S-V)*L+X),Math.round(K*0.1),Math.round((S-V)*L+X),Math.round(K*0.9),O.get("medianColor")).append();if(O.get("target")){W=Math.ceil(O.get("spotRadius"));ac.drawLine(Math.round((O.get("target")-V)*L+X),Math.round((K/2)-W),Math.round((O.get("target")-V)*L+X),Math.round((K/2)+W),O.get("targetColor")).append();ac.drawLine(Math.round((O.get("target")-V)*L+X-W),Math.round(K/2),Math.round((O.get("target")-V)*L+X+W),Math.round(K/2),O.get("targetColor")).append()}ac.render()}});if(i.browser.msie&&document.namespaces&&!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML")}if(i.browser.hasCanvas===undefined){i.browser.hasCanvas=document.createElement("canvas").getContext!==undefined}w=E({init:function(L,M,K,J){this.target=L;this.id=M;this.type=K;this.args=J},append:function(){this.target.appendShape(this);return this}});j=E({_pxregex:/(\d+)(px)?\s*$/i,init:function(K,J,L){if(!K){return}this.width=K;this.height=J;this.target=L;this.lastShapeId=null;if(L[0]){L=L[0]}i.data(L,"_jqs_vcanvas",this)},drawLine:function(L,N,K,M,O,J){return this.drawShape([[L,N],[K,M]],O,J)},drawShape:function(L,K,M,J){return this._genShape("Shape",[L,K,M,J])},drawCircle:function(L,O,K,M,N,J){return this._genShape("Circle",[L,O,K,M,N,J])},drawPieSlice:function(K,P,J,M,L,N,O){return this._genShape("PieSlice",[K,P,J,M,L,N,O])},drawRect:function(K,O,L,J,M,N){return this._genShape("Rect",[K,O,L,J,M,N])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(J,K){i(K).html(J)},_calculatePixelDims:function(M,J,L){var K;K=this._pxregex.exec(J);if(K){this.pixelHeight=K[1]}else{this.pixelHeight=i(L).height()}K=this._pxregex.exec(M);if(K){this.pixelWidth=K[1]}else{this.pixelWidth=i(L).width()}},_genShape:function(K,J){var L=f++;J.unshift(L);return new w(this,L,K,J)},appendShape:function(J){alert("appendShape not implemented")},replaceWithShape:function(K,J){alert("replaceWithShape not implemented")},insertAfterShape:function(K,J){alert("insertAfterShape not implemented")},removeShapeId:function(J){alert("removeShapeId not implemented")},getShapeAt:function(K,J,L){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});y=E(j,{init:function(L,J,M,K){y._super.init.call(this,L,J,M);this.canvas=document.createElement("canvas");if(M[0]){M=M[0]}i.data(M,"_jqs_vcanvas",this);i(this.canvas).css({display:"inline-block",width:L,height:J,verticalAlign:"top"});this._insert(this.canvas,M);this._calculatePixelDims(L,J,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=K;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=undefined;i(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(L,M,J){var K=this.canvas.getContext("2d");if(L!==undefined){K.strokeStyle=L}K.lineWidth=J===undefined?1:J;if(M!==undefined){K.fillStyle=M}return K},reset:function(){var J=this._getContext();J.clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=undefined},_drawShape:function(P,O,N,Q,J){var L=this._getContext(N,Q,J),K,M;L.beginPath();L.moveTo(O[0][0]+0.5,O[0][1]+0.5);for(K=1,M=O.length;K<M;K++){L.lineTo(O[K][0]+0.5,O[K][1]+0.5)}if(N!==undefined){L.stroke()}if(Q!==undefined){L.fill()}if(this.targetX!==undefined&&this.targetY!==undefined&&L.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=P}},_drawCircle:function(O,L,Q,K,N,P,J){var M=this._getContext(N,P,J);M.beginPath();M.arc(L,Q,K,0,2*Math.PI,false);if(this.targetX!==undefined&&this.targetY!==undefined&&M.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=O}if(N!==undefined){M.stroke()}if(P!==undefined){M.fill()}},_drawPieSlice:function(N,R,P,M,O,L,Q,K){var J=this._getContext(Q,K);J.beginPath();J.moveTo(R,P);J.arc(R,P,M,O,L,false);J.lineTo(R,P);J.closePath();if(Q!==undefined){J.stroke()}if(K){J.fill()}if(this.targetX!==undefined&&this.targetY!==undefined&&J.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=N}},_drawRect:function(N,K,P,L,J,M,O){return this._drawShape(N,[[K,P],[K+L,P],[K+L,P+J],[K,P+J],[K,P]],M,O)},appendShape:function(J){this.shapes[J.id]=J;this.shapeseq.push(J.id);this.lastShapeId=J.id;return J.id},replaceWithShape:function(L,J){var M=this.shapeseq,K;this.shapes[J.id]=J;for(K=M.length;K--;){if(M[K]==L){M[K]=J.id}}delete this.shapes[L]},replaceWithShapes:function(L,K){var P=this.shapeseq,N={},J,M,O;for(M=L.length;M--;){N[L[M]]=true}for(M=P.length;M--;){J=P[M];if(N[J]){P.splice(M,1);delete this.shapes[J];O=M}}for(M=K.length;M--;){P.splice(O,0,K[M].id);this.shapes[K[M].id]=K[M]}},insertAfterShape:function(L,J){var M=this.shapeseq,K;for(K=M.length;K--;){if(M[K]===L){M.splice(K+1,0,J.id);this.shapes[J.id]=J;return}}},removeShapeId:function(K){var L=this.shapeseq,J;for(J=L.length;J--;){if(L[J]===K){L.splice(J,1);break}}delete this.shapes[K]},getShapeAt:function(K,J,L){this.targetX=J;this.targetY=L;this.render();return this.currentTargetShapeId},render:function(){var P=this.shapeseq,J=this.shapes,N=P.length,M=this._getContext(),O,K,L;M.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(L=0;L<N;L++){O=P[L];K=J[O];this["_draw"+K.type].apply(this,K.args)}if(!this.interact){this.shapes={};this.shapeseq=[]}}});v=E(j,{init:function(K,J,M){var L;v._super.init.call(this,K,J,M);if(M[0]){M=M[0]}i.data(M,"_jqs_vcanvas",this);this.canvas=document.createElement("span");i(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:K,height:J,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,M);this._calculatePixelDims(K,J,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;L='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>';this.canvas.insertAdjacentHTML("beforeEnd",L);this.group=i(this.canvas).children()[0];this.rendered=false;this.prerender=""},_drawShape:function(O,V,Q,J,M){var R=[],P,U,T,N,S,K,L;for(L=0,K=V.length;L<K;L++){R[L]=""+(V[L][0])+","+(V[L][1])}P=R.splice(0,1);M=M===undefined?1:M;U=Q===undefined?' stroked="false" ':' strokeWeight="'+M+'px" strokeColor="'+Q+'" ';T=J===undefined?' filled="false"':' fillColor="'+J+'" filled="true" ';N=R[0]===R[R.length-1]?"x ":"";S='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+O+'" '+U+T+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+P+" l "+R.join(", ")+" "+N+'e"> </v:shape>';return S},_drawCircle:function(M,P,N,L,O,J,K){var S,R,Q;P-=L;N-=L;S=O===undefined?' stroked="false" ':' strokeWeight="'+K+'px" strokeColor="'+O+'" ';R=J===undefined?' filled="false"':' fillColor="'+J+'" filled="true" ';Q='<v:oval  id="jqsshape'+M+'" '+S+R+' style="position:absolute;top:'+N+"px; left:"+P+"px; width:"+(L*2)+"px; height:"+(L*2)+'px"></v:oval>';return Q},_drawPieSlice:function(Q,V,T,P,R,M,U,L){var S,K,J,O,N,Y,X,W;if(R===M){return}if((M-R)===(2*Math.PI)){R=0;M=(2*Math.PI)}K=V+Math.round(Math.cos(R)*P);J=T+Math.round(Math.sin(R)*P);O=V+Math.round(Math.cos(M)*P);N=T+Math.round(Math.sin(M)*P);if(K===O&&J===N&&(M-R)<Math.PI){return}S=[V-P,T-P,V+P,T+P,K,J,O,N];Y=U===undefined?' stroked="false" ':' strokeWeight="1px" strokeColor="'+U+'" ';X=L===undefined?' filled="false"':' fillColor="'+L+'" filled="true" ';W='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+Q+'" '+Y+X+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+V+","+T+" wa "+S.join(", ")+' x e"> </v:shape>';return W},_drawRect:function(N,K,P,L,J,M,O){return this._drawShape(N,[[K,P],[K,P+J],[K+L,P+J],[K+L,P],[K,P]],M,O)},reset:function(){this.group.innerHTML=""},appendShape:function(J){var K=this["_draw"+J.type].apply(this,J.args);if(this.rendered){this.group.insertAdjacentHTML("beforeEnd",K)}else{this.prerender+=K}this.lastShapeId=J.id;return J.id},replaceWithShape:function(M,J){var L=i("#jqsshape"+M),K=this["_draw"+J.type].apply(this,J.args);L[0].outerHTML=K},replaceWithShapes:function(K,J){var N=i("#jqsshape"+K[0]),M="",O=J.length,L;for(L=0;L<O;L++){M+=this["_draw"+J[L].type].apply(this,J[L].args)}N[0].outerHTML=M;for(L=1;L<K.length;L++){i("#jqsshape"+K[L]).remove()}},insertAfterShape:function(M,J){var L=i("#jqsshape"+M),K=this["_draw"+J.type].apply(this,J.args);L[0].insertAdjacentHTML("afterEnd",K)},removeShapeId:function(K){var J=i("#jqsshape"+K);this.group.removeChild(J[0])},getShapeAt:function(K,J,M){var L=K.id.substr(8);return L},render:function(){if(!this.rendered){this.group.innerHTML=this.prerender;this.rendered=true}}})}));